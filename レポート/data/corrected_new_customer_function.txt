修正された新規顧客数計算関数（#付き対応版）

=LET(
  current_month, A2,
  current_service, B2,
  target_month_start, current_month,
  target_month_end, EOMONTH(current_month, 0),

  // CustomerDBから該当月の顧客を取得
  customers_this_month, FILTER(
    CustomerDB!D:D,
    CustomerDB!U:U = TRUE,
    CustomerDB!V:V = current_service
  ),

  // 新規顧客数をカウント
  IFERROR(COUNTA(UNIQUE(customers_this_month)), 0)
)

この関数は、ServiceDataシートのS列に配置します。

各ストアのサービス名の対応（#付き）：
- #P: Photopri
- #E: E1 Print
- #A: Artgraph  
- #Q: Qoo
- #T: TETTE
- #C: Copy Center Gallery

CustomerDBの列の説明：
- D列: 顧客ID
- U列: 新規顧客フラグ（TRUE/FALSE）
- V列: サービス名（#P, #E, #A, #Q, #T, #C）

注意：CustomerDBのV列も#付きのサービス名で保存する必要があります。
現在のCustomerDBが#なしで保存されている場合は、CustomerDBを再生成する必要があります。

